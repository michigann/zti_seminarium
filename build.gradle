plugins {
	id 'war'  
}

repositories {
	jcenter()
}

dependencies {
	compile 'javax.servlet:javax.servlet-api:3.1.0'
	testCompile 'junit:junit:4.12'
	testCompile 'org.mockito:mockito-core:2.7.19' 
}


// Tomcat tasks

task copyWarToTomcat(type: Copy) {
	description "Copies ${rootProject.name}.war into local Tomcat server"
	
	from "build/libs/${rootProject.name}.war"
	into "C:/Programs/apache-tomcat-8.5.28/webapps"
    
	doFirst {
		println "Copying ${rootProject.name}.war into server..."
	}
	doLast {
		println "${rootProject.name}.war file has been copied"
	}
}

task startTomcat(type: Exec) {
	description 'Starts local Tomcat server'
	
	workingDir 'C:/Programs/apache-tomcat-8.5.28/bin'
	commandLine 'cmd', '/C', 'startup.bat'
    
	doFirst {
		println "Starting Tomcat..."
	}
	doLast {
		println 'Tomcat has been started.'
	}
}

task deployOnTomcat() {
	finalizedBy startTomcat
	dependsOn copyWarToTomcat
}

task stopTomcat(type: Exec) {
	description 'Stops local Tomcat server'
	
	workingDir 'C:/Programs/apache-tomcat-8.5.28/bin'
	commandLine 'cmd', '/C', 'shutdown.bat'
    
	doFirst {
		println 'Stopping Tomcat...'
	}
	doLast {
		println 'Tomcat has been stopped'
	}
}
